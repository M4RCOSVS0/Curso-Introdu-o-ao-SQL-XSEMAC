CREATE DATABASE DB_FUTSAL

USE DB_FUTSAL

CREATE TABLE TB_JOGADORES (
    ID_JOGADOR INT IDENTITY(1,1) PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL,
    POSICAO VARCHAR(50) NOT NULL,
    SALARIO DECIMAL(10,2)
);

CREATE TABLE TB_EQUIPES (
    ID_EQUIPE INT PRIMARY KEY,
    NOME_EQUIPE VARCHAR(100) NOT NULL
);

CREATE TABLE TB_JOGADORES_EQUIPE (
    ID_JOGADOR INT,
    ID_EQUIPE INT,
    PRIMARY KEY (ID_JOGADOR, ID_EQUIPE),
    FOREIGN KEY (ID_JOGADOR) REFERENCES TB_JOGADORES(ID_JOGADOR),
    FOREIGN KEY (ID_EQUIPE) REFERENCES TB_EQUIPES(ID_EQUIPE)
);

INSERT INTO TB_JOGADORES (NOME, POSICAO, SALARIO) VALUES
('ALVARO SANTOS TAVARES', 'ALA', 1200.50),
('ANDERSON ANDRADE SANTOS', 'PIVÔ', 1500.00),
('ANTONIO CHARLISON PEREIRA SANTANA', 'ALA', 1300.75),
('ARTHUR ALVES DOS SANTOS', 'FIXO', 1400.00),
('CLAUDNEY DE JESUS SANTOS', 'GOLEIRO', 2000.00),
('DANIELLE ANDRADE SANTOS', 'ALA', 1250.00),
('DAVID SANTOS MENEZES', 'GOLEIRO', 1900.00),
('FELIPE MENDONÇA DO SACRAMENTO', 'FIXO', 1450.00),
('GABRIEL DE JESUS OLIVEIRA', 'ALA', 1200.00),
('GABRIEL VINICIUS SOUZA DA SILVA', 'PIVÔ', 1550.50),
('JORGE EDUARDO FREIRE DO NASCIMENTO SANTOS', 'ALA', 1275.25),
('JOSE RAMON OLIVEIRA DO ESPIRITO SANTO', 'GOLEIRO', 2100.00),
('JULIANO CARLOS DOS SANTOS', 'FIXO', 1350.00),
('LEANDRO MENDONÇA CARVALHO', 'ALA', 1200.00),
('MATHEUS SANTIAGO SILVA', 'PIVÔ', 1520.00),
('PABLO RAFAEL DOS SANTOS', 'ALA', 1300.00),
('RIAN SANTOS DE SOUZA', 'FIXO', 1380.00),
('TALYSSON FELIPE VASCONCELOS SANTOS', 'ALA', 1225.00),
('THIAGO SANTANA SANTOS', 'GOLEIRO', 2050.00),
('WALLACE GABRIEL SANTOS DE JESUS', 'ALA', 1230.00),
('WILLIAM BRAYON CARDOSO SANTANA SANTOS', 'PIVÔ', 1500.00),
('WILMA', 'ALA', 1260.00),
('YASMIM PASSOS ALVES DE ARAUJO', 'FIXO', 1375.00),
('IAN TAVARES', 'PIVÔ', 1450.00);


INSERT INTO TB_EQUIPES (ID_EQUIPE, NOME_EQUIPE) VALUES
(1, 'FUMAÇA FC'),
(2, 'REAL INVASÃO FC'),
(3, 'DENDENZEIRO FC'),
(4, 'ATLÉTICO DA RUA DA LAMA'),
(5, 'GRÊMIO DA TERRA DURA');

INSERT INTO TB_JOGADORES_EQUIPE (ID_JOGADOR, ID_EQUIPE) VALUES
(1, 1),  -- FUMAÇA FC
(2, 1),
(3, 1),
(4, 1),
(5, 1),
(6, 2),  -- REAL INVASÃO FC
(7, 2),
(8, 2),
(9, 2),
(10, 2),
(11, 3), -- DENDENZEIRO FC
(12, 3),
(13, 3),
(14, 3),
(15, 3),
(16, 4), -- ATLÉTICO DA RUA DA LAMA
(17, 4),
(18, 4),
(19, 4),
(20, 4),
(21, 5), -- GRÊMIO DA TERRA DURA
(22, 5),
(23, 5),
(24, 5),
(25, 5);

--EXERCÍCIOS COM FUNÇÃO DE AGREGAÇÃO
--1- Conte quantos jogadores possuem salários acima de 2000. Use HAVING para filtrar.

--2- Calcule o total de salários de jogadores, agrupados por posição.

--3- Calcule a média salarial de todos os jogadores.

--4- Identifique o menor salário pago a um jogador em cada posição.

--5-Determine o maior salário de um jogador por equipe.(VAI PRECISAR DE JOIN)

SELECT
    *
FROM
    TB_JOGADORES J
JOIN
    TB_JOGADORES_EQUIPE JE ON J.ID_JOGADOR = JE.ID_JOGADOR
JOIN
    TB_EQUIPES EQ ON JE.ID_EQUIPE = EQ.ID_EQUIPE
GROUP BY